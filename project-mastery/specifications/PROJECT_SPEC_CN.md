# Signalist è‚¡ç¥¨è¿½è¸ªåº”ç”¨ - æŠ€æœ¯è§„æ ¼æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è§ˆ

**é¡¹ç›®åç§°ï¼š** Signalist Stock Tracker App
**é¡¹ç›®ç±»å‹ï¼š** AIé©±åŠ¨çš„è‚¡ç¥¨å¸‚åœºè¿½è¸ªå…¨æ ˆWebåº”ç”¨
**æŠ€æœ¯æ ˆï¼š** Next.js 15 + React 19 + TypeScript + MongoDB + Tailwind CSS

### ä¸»è¦åŠŸèƒ½

1. **å®æ—¶è‚¡ç¥¨è¿½è¸ª** - é€šè¿‡TradingViewå›¾è¡¨æŸ¥çœ‹å®æ—¶ä»·æ ¼å’Œå†å²æ•°æ®
2. **æ™ºèƒ½æœç´¢** - å¿«é€Ÿæœç´¢è‚¡ç¥¨ï¼ˆCmd/Ctrl+Kå¿«æ·é”®ï¼‰
3. **ä¸ªäººç›‘æ§åˆ—è¡¨** - åˆ›å»ºå’Œç®¡ç†å…³æ³¨çš„è‚¡ç¥¨åˆ—è¡¨
4. **å…¬å¸æ·±åº¦åˆ†æ** - æŸ¥çœ‹è´¢åŠ¡æ•°æ®ã€æŠ€æœ¯åˆ†æã€å…¬å¸ç®€ä»‹
5. **AIé©±åŠ¨é€šçŸ¥** - ä¸ªæ€§åŒ–æ¬¢è¿é‚®ä»¶å’Œæ¯æ—¥å¸‚åœºæ–°é—»æ‘˜è¦
6. **äº‹ä»¶é©±åŠ¨æ¶æ„** - è‡ªåŠ¨åŒ–å·¥ä½œæµå¤„ç†å¼‚æ­¥ä»»åŠ¡

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ç”¨æˆ·æµè§ˆå™¨ (Browser)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ React 19 UI (Server + Client Components) â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†• HTTPS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Next.js 15 App Router (Vercel)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Server     â”‚  â”‚ API Routes   â”‚               â”‚
â”‚  â”‚ Components â”‚  â”‚ /api/inngest â”‚               â”‚
â”‚  â”‚ + Actions  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†•                â†•               â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MongoDB   â”‚  â”‚   Finnhub    â”‚  â”‚ Inngest  â”‚
â”‚  (æ•°æ®åº“)   â”‚  â”‚   (è‚¡ç¥¨API)  â”‚  â”‚ (äº‹ä»¶)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†•               â†•
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  TradingView â”‚  â”‚  Gemini  â”‚
                â”‚   (å›¾è¡¨)     â”‚  â”‚   (AI)   â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆè¯¦è§£

| å±‚æ¬¡ | æŠ€æœ¯ | ç‰ˆæœ¬ | ä½œç”¨ |
|------|------|------|------|
| **å‰ç«¯** | Next.js | 15.5.2 | Reactå…¨æ ˆæ¡†æ¶ï¼ŒSSR/SSG |
| | React | 19.1.0 | UIç»„ä»¶åº“ |
| | TypeScript | 5 | ç±»å‹å®‰å…¨ |
| | Tailwind CSS | 4 | CSSæ¡†æ¶ |
| | Shadcn UI | - | UIç»„ä»¶åº“ |
| **åç«¯** | Next.js API Routes | 15.5.2 | APIç«¯ç‚¹ |
| | Server Actions | - | æœåŠ¡å™¨ç«¯å‡½æ•° |
| **æ•°æ®åº“** | MongoDB | 6.19.0 | NoSQLæ•°æ®åº“ |
| | Mongoose | 8.18.0 | ODMæ¡†æ¶ |
| **è®¤è¯** | Better Auth | 1.3.7 | é‚®ç®±å¯†ç è®¤è¯ |
| **äº‹ä»¶é©±åŠ¨** | Inngest | 3.40.1 | å·¥ä½œæµå¹³å° |
| **å¤–éƒ¨API** | Finnhub | - | è‚¡ç¥¨æ•°æ® |
| | TradingView | - | å›¾è¡¨ç»„ä»¶ |
| | Gemini | - | AIå†…å®¹ç”Ÿæˆ |
| **é‚®ä»¶** | Nodemailer | 7.0.6 | é‚®ä»¶å‘é€ |

---

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### ERå…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  user (Better Auth) â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ id: String (PK)     â”‚â”€â”€â”€â”
â”‚ email: String (UK)  â”‚   â”‚ 1å¯¹å¤šå…³ç³»
â”‚ name: String        â”‚   â”‚ (One-to-Many)
â”‚ emailVerified: Bool â”‚   â”‚
â”‚ createdAt: Date     â”‚   â”‚
â”‚ updatedAt: Date     â”‚   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                          â”‚
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   watchlists        â”‚   â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚   â”‚
â”‚ _id: ObjectId (PK)  â”‚   â”‚
â”‚ userId: String (FK) â”‚â”€â”€â”€â”˜
â”‚ symbol: String      â”‚
â”‚ company: String     â”‚
â”‚ addedAt: Date       â”‚
â”‚                     â”‚
â”‚ UNIQUE(userId,      â”‚
â”‚        symbol)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æ¨¡å‹è¯¦è§£

#### useré›†åˆï¼ˆBetter Authè‡ªåŠ¨åˆ›å»ºï¼‰

| å­—æ®µ | ç±»å‹ | å¿…éœ€ | è¯´æ˜ |
|------|------|------|------|
| id | String | âœ… | Better Authç”Ÿæˆçš„ç”¨æˆ·ID |
| email | String | âœ… | ç”¨æˆ·é‚®ç®±ï¼ˆå”¯ä¸€ï¼‰ |
| name | String | âœ… | ç”¨æˆ·å…¨å |
| emailVerified | Boolean | âŒ | é‚®ç®±éªŒè¯çŠ¶æ€ |
| createdAt | Date | âœ… | åˆ›å»ºæ—¶é—´ |
| updatedAt | Date | âœ… | æ›´æ–°æ—¶é—´ |

**ç¤ºä¾‹æ–‡æ¡£ï¼š**
```json
{
  "id": "user_cm3kx9y8z0001",
  "email": "john@example.com",
  "name": "John Doe",
  "emailVerified": false,
  "createdAt": "2025-11-16T08:00:00Z",
  "updatedAt": "2025-11-16T08:00:00Z"
}
```

#### watchlistsé›†åˆ

| å­—æ®µ | ç±»å‹ | å¿…éœ€ | çº¦æŸ | è¯´æ˜ |
|------|------|------|------|------|
| _id | ObjectId | âœ… | è‡ªåŠ¨ç”Ÿæˆ | MongoDBå”¯ä¸€ID |
| userId | String | âœ… | ç´¢å¼• | å…³è”user.id |
| symbol | String | âœ… | uppercase, trim | è‚¡ç¥¨ä»£ç  |
| company | String | âœ… | trim | å…¬å¸åç§° |
| addedAt | Date | âœ… | default:Date.now | æ·»åŠ æ—¶é—´ |

**å¤åˆå”¯ä¸€ç´¢å¼•ï¼š** `{ userId: 1, symbol: 1 }`
**ä½œç”¨ï¼š** é˜²æ­¢ç”¨æˆ·é‡å¤æ·»åŠ ç›¸åŒè‚¡ç¥¨

**ç¤ºä¾‹æ–‡æ¡£ï¼š**
```json
{
  "_id": "ObjectId('673d5f8a1234567890abcdef')",
  "userId": "user_cm3kx9y8z0001",
  "symbol": "AAPL",
  "company": "Apple Inc.",
  "addedAt": "2025-11-16T08:30:00Z"
}
```

---

## ğŸ”„ æ ¸å¿ƒä¸šåŠ¡æµç¨‹

### æµç¨‹1ï¼šç”¨æˆ·æ³¨å†Œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·    â”‚
â”‚ è®¿é—®æ³¨å†Œé¡µâ”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¡«å†™æ³¨å†Œè¡¨å•            â”‚
â”‚ - é‚®ç®±                  â”‚
â”‚ - å¯†ç ï¼ˆâ‰¥8å­—ç¬¦ï¼‰        â”‚
â”‚ - å…¨å                  â”‚
â”‚ - å›½å®¶                  â”‚
â”‚ - æŠ•èµ„ç›®æ ‡              â”‚
â”‚ - é£é™©æ‰¿å—èƒ½åŠ›          â”‚
â”‚ - åå¥½è¡Œä¸š              â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å®¢æˆ·ç«¯éªŒè¯              â”‚
â”‚ - Emailæ ¼å¼æ£€æŸ¥         â”‚
â”‚ - å¯†ç é•¿åº¦æ£€æŸ¥          â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Server Action:          â”‚
â”‚ signUpWithEmail()       â”‚
â”‚ ä½ç½®: lib/actions/      â”‚
â”‚       auth.actions.ts:7 â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Better Auth API         â”‚
â”‚ - åˆ›å»ºç”¨æˆ·è´¦æˆ·          â”‚
â”‚ - å¯†ç å“ˆå¸Œå­˜å‚¨          â”‚
â”‚ - å†™å…¥MongoDB           â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è§¦å‘Inngestäº‹ä»¶         â”‚
â”‚ 'app/user.created'      â”‚
â”‚ åŒ…å«ç”¨æˆ·åå¥½æ•°æ®        â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Inngestå·¥ä½œæµ           â”‚
â”‚ sendSignUpEmail()       â”‚
â”‚ ä½ç½®: lib/inngest/      â”‚
â”‚       functions.ts:9    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼
     â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚              â”‚ Gemini AIç”Ÿæˆ    â”‚
     â”‚              â”‚ ä¸ªæ€§åŒ–æ¬¢è¿æ–‡æœ¬   â”‚
     â”‚              â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                    â”‚
     â”‚                    â–¼
     â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚              â”‚ Nodemailerå‘é€   â”‚
     â”‚              â”‚ æ¬¢è¿é‚®ä»¶         â”‚
     â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¿”å›æˆåŠŸ                â”‚
â”‚ è‡ªåŠ¨ç™»å½•                â”‚
â”‚ é‡å®šå‘åˆ°é¦–é¡µ            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ¶‰åŠä»£ç ä½ç½®ï¼š**
- è¡¨å•ç»„ä»¶ï¼š`app/(auth)/sign-up/page.tsx`
- Server Actionï¼š`lib/actions/auth.actions.ts:7-23`
- Inngestå‡½æ•°ï¼š`lib/inngest/functions.ts:9-49`
- é‚®ä»¶å‘é€ï¼š`lib/nodemailer/index.ts:12-26`

---

### æµç¨‹2ï¼šè‚¡ç¥¨æœç´¢æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·    â”‚
â”‚æŒ‰Cmd+K â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‰“å¼€æœç´¢å¯¹è¯æ¡†          â”‚
â”‚ æ˜¾ç¤ºçƒ­é—¨è‚¡ç¥¨ï¼ˆå‰10ä¸ªï¼‰   â”‚
â”‚ æ¥æºï¼šPOPULAR_STOCK_    â”‚
â”‚       SYMBOLSå¸¸é‡        â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·è¾“å…¥ "apple"        â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é˜²æŠ–å»¶è¿Ÿ 300ms          â”‚
â”‚ Hook: useDebounce       â”‚
â”‚ ä½ç½®: hooks/            â”‚
â”‚       useDebounce.ts    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Server Action:          â”‚
â”‚ searchStocks("apple")   â”‚
â”‚ ä½ç½®: lib/actions/      â”‚
â”‚     finnhub.actions.ts  â”‚
â”‚                :101     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Finnhub APIè°ƒç”¨         â”‚
â”‚ GET /search?q=apple     â”‚
â”‚ ç¼“å­˜ï¼š30åˆ†é’Ÿ            â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¿”å›æœç´¢ç»“æœ            â”‚
â”‚ [                       â”‚
â”‚   {symbol:"AAPL",       â”‚
â”‚    name:"Apple Inc."},  â”‚
â”‚   ...                   â”‚
â”‚ ]                       â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ˜¾ç¤ºç»“æœåˆ—è¡¨            â”‚
â”‚ ç”¨æˆ·ç‚¹å‡» AAPL           â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¯¼èˆªåˆ°                  â”‚
â”‚ /stocks/AAPL            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ¶‰åŠä»£ç ä½ç½®ï¼š**
- æœç´¢ç»„ä»¶ï¼š`components/SearchCommand.tsx`
- é˜²æŠ–Hookï¼š`hooks/useDebounce.ts`
- Server Actionï¼š`lib/actions/finnhub.actions.ts:101-180`
- å¸¸é‡å®šä¹‰ï¼š`lib/constants.ts:265-325`

---

### æµç¨‹3ï¼šæ¯æ—¥æ–°é—»æ¨é€æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cronè§¦å‘å™¨       â”‚
â”‚ æ¯å¤©UTC 12:00    â”‚
â”‚ (åŒ—äº¬æ—¶é—´20:00)  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Inngestå‡½æ•°             â”‚
â”‚ sendDailyNewsSummary()  â”‚
â”‚ ä½ç½®: lib/inngest/      â”‚
â”‚       functions.ts:51   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1: è·å–æ‰€æœ‰ç”¨æˆ·    â”‚
â”‚ getAllUsersForNewsEmailâ”‚
â”‚ æŸ¥è¯¢ï¼šdb.collection(   â”‚
â”‚   'user').find({       â”‚
â”‚   email:{$exists:true}â”‚
â”‚ })                     â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2: å¯¹æ¯ä¸ªç”¨æˆ·      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 2.1 è·å–ç›‘æ§åˆ—è¡¨    â”‚ â”‚
â”‚ â”‚ getWatchlistSymbols â”‚ â”‚
â”‚ â”‚ ByEmail(email)      â”‚ â”‚
â”‚ â”‚ â†’ ["AAPL","GOOGL"] â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚                 â”‚
â”‚       â–¼                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 2.2 è·å–è‚¡ç¥¨æ–°é—»    â”‚ â”‚
â”‚ â”‚ getNews(symbols)    â”‚ â”‚
â”‚ â”‚ Finnhub API:        â”‚ â”‚
â”‚ â”‚ /company-news       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚                 â”‚
â”‚       â–¼                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 2.3 AIç”Ÿæˆæ‘˜è¦      â”‚ â”‚
â”‚ â”‚ step.ai.infer()     â”‚ â”‚
â”‚ â”‚ Gemini API          â”‚ â”‚
â”‚ â”‚ â†’ HTMLæ ¼å¼æ–°é—»      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3: æ‰¹é‡å‘é€é‚®ä»¶    â”‚
â”‚ Promise.all([           â”‚
â”‚   sendNewsSummaryEmail  â”‚
â”‚   (user1),              â”‚
â”‚   sendNewsSummaryEmail  â”‚
â”‚   (user2),              â”‚
â”‚   ...                   â”‚
â”‚ ])                      â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‰€æœ‰ç”¨æˆ·æ”¶åˆ°é‚®ä»¶        â”‚
â”‚ ä¸»é¢˜ï¼šğŸ“ˆ Market News   â”‚
â”‚      Summary Today      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ¶‰åŠä»£ç ä½ç½®ï¼š**
- Inngestå‡½æ•°ï¼š`lib/inngest/functions.ts:51-120`
- è·å–ç”¨æˆ·ï¼š`lib/actions/user.actions.ts:5-25`
- è·å–ç›‘æ§åˆ—è¡¨ï¼š`lib/actions/watchlist.actions.ts:6-28`
- è·å–æ–°é—»ï¼š`lib/actions/finnhub.actions.ts:25-99`
- å‘é€é‚®ä»¶ï¼š`lib/nodemailer/index.ts:28-44`

---

## ğŸ”Œ APIæ¥å£æ–‡æ¡£

### 1. ç”¨æˆ·è®¤è¯API

#### æ³¨å†Œ (Server Action)

**å‡½æ•°åï¼š** `signUpWithEmail`
**æ–‡ä»¶ä½ç½®ï¼š** `lib/actions/auth.actions.ts:7-23`

**è¯·æ±‚å‚æ•°ï¼š**
```typescript
{
  email: string;              // é‚®ç®±åœ°å€
  password: string;           // å¯†ç ï¼ˆâ‰¥8å­—ç¬¦ï¼‰
  fullName: string;           // å…¨å
  country: string;            // å›½å®¶
  investmentGoals: string;    // æŠ•èµ„ç›®æ ‡
  riskTolerance: string;      // é£é™©æ‰¿å—èƒ½åŠ›
  preferredIndustry: string;  // åå¥½è¡Œä¸š
}
```

**è¿”å›å€¼ï¼š**
```typescript
{
  success: boolean;
  data?: object;   // Better Authå“åº”
  error?: string;  // é”™è¯¯æ¶ˆæ¯
}
```

**è°ƒç”¨ç¤ºä¾‹ï¼š**
```typescript
const result = await signUpWithEmail({
  email: "john@example.com",
  password: "SecurePass123",
  fullName: "John Doe",
  country: "United States",
  investmentGoals: "Growth",
  riskTolerance: "Medium",
  preferredIndustry: "Technology"
});

if (result.success) {
  // æ³¨å†ŒæˆåŠŸï¼Œè‡ªåŠ¨ç™»å½•
  router.push('/');
} else {
  // æ˜¾ç¤ºé”™è¯¯
  toast.error(result.error);
}
```

---

#### ç™»å½• (Server Action)

**å‡½æ•°åï¼š** `signInWithEmail`
**æ–‡ä»¶ä½ç½®ï¼š** `lib/actions/auth.actions.ts:25-34`

**è¯·æ±‚å‚æ•°ï¼š**
```typescript
{
  email: string;     // é‚®ç®±åœ°å€
  password: string;  // å¯†ç 
}
```

**è¿”å›å€¼ï¼š** åŒæ³¨å†ŒAPI

**è°ƒç”¨ç¤ºä¾‹ï¼š**
```typescript
const result = await signInWithEmail({
  email: "john@example.com",
  password: "SecurePass123"
});
```

---

### 2. è‚¡ç¥¨æ•°æ®API

#### æœç´¢è‚¡ç¥¨ (Server Action)

**å‡½æ•°åï¼š** `searchStocks`
**æ–‡ä»¶ä½ç½®ï¼š** `lib/actions/finnhub.actions.ts:101-180`

**è¯·æ±‚å‚æ•°ï¼š**
```typescript
query?: string;  // æœç´¢å…³é”®è¯ï¼ˆå¯é€‰ï¼‰
```

**è¿”å›å€¼ï¼š**
```typescript
StockWithWatchlistStatus[] = [
  {
    symbol: string;        // è‚¡ç¥¨ä»£ç ï¼ˆå¤§å†™ï¼‰
    name: string;          // å…¬å¸åç§°
    exchange: string;      // äº¤æ˜“æ‰€
    type: string;          // ç±»å‹ï¼ˆå¦‚"Common Stock"ï¼‰
    isInWatchlist: boolean;// æ˜¯å¦åœ¨ç›‘æ§åˆ—è¡¨
  }
]
```

**è°ƒç”¨ç¤ºä¾‹ï¼š**
```typescript
// è·å–çƒ­é—¨è‚¡ç¥¨ï¼ˆæ— å‚æ•°ï¼‰
const popularStocks = await searchStocks();
// è¿”å›å‰10åªçƒ­é—¨è‚¡ç¥¨

// æœç´¢ç‰¹å®šè‚¡ç¥¨
const results = await searchStocks("apple");
// è¿”å›åŒ¹é…"apple"çš„å‰15ä¸ªç»“æœ
```

---

#### è·å–å¸‚åœºæ–°é—» (Server Action)

**å‡½æ•°åï¼š** `getNews`
**æ–‡ä»¶ä½ç½®ï¼š** `lib/actions/finnhub.actions.ts:25-99`

**è¯·æ±‚å‚æ•°ï¼š**
```typescript
symbols?: string[];  // è‚¡ç¥¨ä»£ç æ•°ç»„ï¼ˆå¯é€‰ï¼‰
```

**è¿”å›å€¼ï¼š**
```typescript
MarketNewsArticle[] = [
  {
    id: number;
    headline: string;    // æ ‡é¢˜
    summary: string;     // æ‘˜è¦ï¼ˆ150-200å­—ç¬¦ï¼‰
    source: string;      // æ¥æº
    url: string;         // æ–‡ç« é“¾æ¥
    datetime: number;    // æ—¶é—´æˆ³
    image: string;       // å›¾ç‰‡URL
    category: string;    // åˆ†ç±»
    related: string;     // ç›¸å…³è‚¡ç¥¨ä»£ç 
  }
]
```

**è°ƒç”¨ç¤ºä¾‹ï¼š**
```typescript
// è·å–é€šç”¨å¸‚åœºæ–°é—»
const generalNews = await getNews();

// è·å–ç‰¹å®šè‚¡ç¥¨æ–°é—»
const appleNews = await getNews(["AAPL", "MSFT"]);
// è¿”å›AAPLå’ŒMSFTçš„æ–°é—»ï¼ˆround-robinç®—æ³•ï¼Œæœ€å¤š6ç¯‡ï¼‰
```

---

### 3. ç›‘æ§åˆ—è¡¨API

#### è·å–ç”¨æˆ·ç›‘æ§åˆ—è¡¨ (Server Action)

**å‡½æ•°åï¼š** `getWatchlistSymbolsByEmail`
**æ–‡ä»¶ä½ç½®ï¼š** `lib/actions/watchlist.actions.ts:6-28`

**è¯·æ±‚å‚æ•°ï¼š**
```typescript
email: string;  // ç”¨æˆ·é‚®ç®±
```

**è¿”å›å€¼ï¼š**
```typescript
string[]  // è‚¡ç¥¨ä»£ç æ•°ç»„
```

**è°ƒç”¨ç¤ºä¾‹ï¼š**
```typescript
const symbols = await getWatchlistSymbolsByEmail("john@example.com");
// è¿”å›: ["AAPL", "GOOGL", "MSFT"]
```

---

### 4. Inngest Webhook API

**è·¯å¾„ï¼š** `/api/inngest`
**æ–¹æ³•ï¼š** `GET`, `POST`, `PUT`
**æ–‡ä»¶ä½ç½®ï¼š** `app/api/inngest/route.ts`

**è¯´æ˜ï¼š** è¿™æ˜¯Inngestå¹³å°çš„webhookç«¯ç‚¹ï¼Œç”¨äºæ¥æ”¶å’Œå¤„ç†äº‹ä»¶ã€‚

**æ³¨å†Œçš„äº‹ä»¶ï¼š**
1. `app/user.created` - ç”¨æˆ·æ³¨å†Œåè§¦å‘
2. `app/send.daily.news` - æ‰‹åŠ¨è§¦å‘æ¯æ—¥æ–°é—»ï¼ˆæˆ–Cronè‡ªåŠ¨è§¦å‘ï¼‰

**ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨**ï¼Œç”±Inngestå¹³å°è‡ªåŠ¨ç®¡ç†ã€‚

---

## âš™ï¸ ç¯å¢ƒé…ç½®æŒ‡å—

### å¿…éœ€çš„ç¯å¢ƒå˜é‡

åˆ›å»º `.env.local` æ–‡ä»¶ï¼š

```env
# è¿è¡Œç¯å¢ƒ
NODE_ENV=development
NEXT_PUBLIC_BASE_URL=http://localhost:3000

# MongoDBæ•°æ®åº“
MONGODB_URI=your-mongodb-uri-here

# Better Authè®¤è¯
BETTER_AUTH_SECRET=your-secret-min-32-characters
BETTER_AUTH_URL=http://localhost:3000

# Finnhubè‚¡ç¥¨API
FINNHUB_API_KEY=your-finnhub-api-key
NEXT_PUBLIC_FINNHUB_API_KEY=your-finnhub-api-key
FINNHUB_BASE_URL=https://finnhub.io/api/v1

# Google Gemini AI
GEMINI_API_KEY=your-gemini-api-key

# Nodemaileré‚®ä»¶æœåŠ¡
NODEMAILER_EMAIL=your-email@gmail.com
NODEMAILER_PASSWORD=your-gmail-app-password
```

### ç¯å¢ƒå˜é‡è·å–æ–¹å¼

#### 1. MongoDB URI

**æ–¹å¼1ï¼šMongoDB Atlasï¼ˆæ¨èï¼‰**

1. è®¿é—® https://www.mongodb.com/cloud/atlas
2. æ³¨å†Œå¹¶åˆ›å»ºå…è´¹é›†ç¾¤
3. åˆ›å»ºæ•°æ®åº“ç”¨æˆ·
4. é…ç½®ç½‘ç»œè®¿é—®ï¼ˆå…è®¸æ‰€æœ‰IPï¼š0.0.0.0/0ï¼‰
5. è·å–è¿æ¥å­—ç¬¦ä¸²

**ç¤ºä¾‹è¿æ¥å­—ç¬¦ä¸²ï¼š**
```
mongodb+srv://username:password@cluster0.xxxxx.mongodb.net/signalist?retryWrites=true&w=majority
```

**æ–¹å¼2ï¼šæœ¬åœ°MongoDB**
```
mongodb://localhost:27017/signalist
```

---

#### 2. Better Auth Secret

**ç”Ÿæˆæ–¹å¼ï¼ˆåœ¨ç»ˆç«¯æ‰§è¡Œï¼‰ï¼š**
```bash
# macOS/Linux
openssl rand -base64 32

# Windows (PowerShell)
[Convert]::ToBase64String((1..32|%{Get-Random -Max 256}))
```

**ç¤ºä¾‹ï¼š**
```
BETTER_AUTH_SECRET=XyZ123AbC456DeF789GhI012JkL345MnO678PqR901StU234
```

---

#### 3. Finnhub API Key

1. è®¿é—® https://finnhub.io/register
2. æ³¨å†Œå…è´¹è´¦æˆ·
3. åœ¨Dashboardè·å–APIå¯†é’¥

**å…è´¹å±‚çº§é™åˆ¶ï¼š**
- 60 API calls/minute
- é¡¹ç›®ä½¿ç”¨ç¼“å­˜ç­–ç•¥ï¼Œå®é™…è°ƒç”¨é¢‘ç‡å¾ˆä½

---

#### 4. Gemini API Key

1. è®¿é—® https://aistudio.google.com/
2. ç™»å½•Googleè´¦æˆ·
3. åˆ›å»ºAPIå¯†é’¥

**å…è´¹å±‚çº§ï¼š**
- æ¯åˆ†é’Ÿ15æ¬¡è¯·æ±‚
- æ¯å¤©1500æ¬¡è¯·æ±‚
- é¡¹ç›®ä½¿ç”¨é¢‘ç‡ä½äºé™åˆ¶

---

#### 5. Gmailåº”ç”¨ä¸“ç”¨å¯†ç ï¼ˆNodemailerï¼‰

1. ç™»å½•Gmailè´¦æˆ·
2. è®¿é—® https://myaccount.google.com/security
3. å¯ç”¨ä¸¤æ­¥éªŒè¯
4. æœç´¢"åº”ç”¨ä¸“ç”¨å¯†ç "
5. åˆ›å»ºæ–°å¯†ç ï¼ˆé€‰æ‹©"é‚®ä»¶"å’Œ"å…¶ä»–"ï¼‰
6. å¤åˆ¶16ä½å¯†ç 

**é…ç½®ç¤ºä¾‹ï¼š**
```env
NODEMAILER_EMAIL=yourname@gmail.com
NODEMAILER_PASSWORD=abcd efgh ijkl mnop
```

---

## ğŸš€ æœ¬åœ°å¼€å‘æŒ‡å—

### å¼€å‘ç¯å¢ƒæ­å»º

**å‰ç½®è¦æ±‚ï¼š**
- Node.js â‰¥ 20.0.0
- npm â‰¥ 8.0.0
- Git

**æ­¥éª¤1ï¼šå…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/adrianhajdin/signalist_stock-tracker-app.git
cd signalist_stock-tracker-app
```

**æ­¥éª¤2ï¼šå®‰è£…ä¾èµ–**
```bash
npm install
```

**æ­¥éª¤3ï¼šé…ç½®ç¯å¢ƒå˜é‡**
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env.local

# ç¼–è¾‘.env.localï¼Œå¡«å†™å®é™…çš„APIå¯†é’¥
nano .env.local  # æˆ–ä½¿ç”¨ä½ å–œæ¬¢çš„ç¼–è¾‘å™¨
```

**æ­¥éª¤4ï¼šå¯åŠ¨å¼€å‘æœåŠ¡å™¨**
```bash
# ç»ˆç«¯1ï¼šå¯åŠ¨Next.jså¼€å‘æœåŠ¡å™¨
npm run dev

# ç»ˆç«¯2ï¼šå¯åŠ¨Inngestå¼€å‘æœåŠ¡å™¨
npx inngest-cli@latest dev
```

**è®¿é—®åº”ç”¨ï¼š**
- ä¸»åº”ç”¨ï¼šhttp://localhost:3000
- Inngest Dev Serverï¼šhttp://localhost:8288

---

### å¸¸è§å¼€å‘ä»»åŠ¡

#### æ·»åŠ æ–°çš„æ•°æ®æ¨¡å‹

**ç¤ºä¾‹ï¼šæ·»åŠ Alertï¼ˆä»·æ ¼æé†’ï¼‰æ¨¡å‹**

1. åˆ›å»ºæ–‡ä»¶ `database/models/alert.model.ts`ï¼š

```typescript
import { Schema, model, models, type Model } from 'mongoose';

export interface Alert extends Document {
  userId: string;
  symbol: string;
  alertType: 'upper' | 'lower';  // é«˜äº/ä½äº
  threshold: number;              // è§¦å‘ä»·æ ¼
  createdAt: Date;
}

const AlertSchema = new Schema<Alert>({
  userId: { type: String, required: true, index: true },
  symbol: { type: String, required: true, uppercase: true },
  alertType: { type: String, enum: ['upper', 'lower'], required: true },
  threshold: { type: Number, required: true },
  createdAt: { type: Date, default: Date.now },
});

// ç´¢å¼•ä¼˜åŒ–
AlertSchema.index({ userId: 1, symbol: 1 });

export const AlertModel: Model<Alert> =
  models?.Alert || model<Alert>('Alert', AlertSchema);
```

2. åˆ›å»ºServer Action `lib/actions/alert.actions.ts`ï¼š

```typescript
'use server';
import { AlertModel } from '@/database/models/alert.model';
import { connectToDatabase } from '@/database/mongoose';

export const createAlert = async (data: CreateAlertData) => {
  try {
    await connectToDatabase();
    const alert = await AlertModel.create(data);
    return { success: true, data: alert };
  } catch (error) {
    return { success: false, error: 'Failed to create alert' };
  }
}
```

---

#### è°ƒè¯•æŠ€å·§

**1. æŸ¥çœ‹Server Actionæ—¥å¿—ï¼š**
```typescript
// åœ¨Server Actionä¸­æ·»åŠ console.log
export const signUpWithEmail = async (data: SignUpFormData) => {
    console.log('Sign up attempt:', data.email);  // æŸ¥çœ‹ç»ˆç«¯è¾“å‡º
    // ...
}
```

**2. æŸ¥çœ‹æ•°æ®åº“æ•°æ®ï¼š**
```bash
# ä½¿ç”¨MongoDB Compassè¿æ¥æ•°æ®åº“
# æˆ–ä½¿ç”¨æµ‹è¯•è„šæœ¬
npm run test:db
```

**3. è°ƒè¯•APIè¯·æ±‚ï¼š**
```typescript
// åœ¨æµè§ˆå™¨ConsoleæŸ¥çœ‹ç½‘ç»œè¯·æ±‚
// æˆ–åœ¨Server Actionæ·»åŠ æ—¥å¿—
const response = await fetch(url);
console.log('API Response:', await response.json());
```

---

## ğŸ”§ äºŒæ¬¡å¼€å‘æŒ‡å—

### å¸¸è§æ‰©å±•åœºæ™¯

#### åœºæ™¯1ï¼šæ·»åŠ ä»·æ ¼é¢„è­¦åŠŸèƒ½

**éœ€æ±‚ï¼š** å½“è‚¡ç¥¨ä»·æ ¼é«˜äº/ä½äºè®¾å®šå€¼æ—¶å‘é€é‚®ä»¶é€šçŸ¥

**å¼€å‘æ­¥éª¤ï¼š**

1. åˆ›å»ºAlertæ•°æ®æ¨¡å‹ï¼ˆè§ä¸Šæ–‡ï¼‰

2. åˆ›å»ºUIç»„ä»¶ `components/AlertDialog.tsx`

3. åˆ›å»ºInngestå‡½æ•° `lib/inngest/functions.ts`ï¼š

```typescript
export const checkPriceAlerts = inngest.createFunction(
  { id: 'check-price-alerts' },
  { cron: '*/5 * * * *' },  // æ¯5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
  async ({ step }) => {
    // 1. è·å–æ‰€æœ‰æ´»è·ƒçš„alerts
    // 2. è·å–è¿™äº›è‚¡ç¥¨çš„å½“å‰ä»·æ ¼
    // 3. æ£€æŸ¥æ˜¯å¦è§¦å‘æ¡ä»¶
    // 4. å‘é€é€šçŸ¥é‚®ä»¶
  }
)
```

4. æ³¨å†Œåˆ°Inngestè·¯ç”±

---

#### åœºæ™¯2ï¼šæ·»åŠ æ–°é¡µé¢ï¼ˆå¦‚ç›‘æ§åˆ—è¡¨é¡µï¼‰

**æ­¥éª¤ï¼š**

1. åˆ›å»ºé¡µé¢æ–‡ä»¶ `app/(root)/watchlist/page.tsx`ï¼š

```typescript
import { auth } from '@/lib/better-auth/auth';
import { headers } from 'next/headers';
import { getWatchlistSymbolsByEmail } from '@/lib/actions/watchlist.actions';

export default async function WatchlistPage() {
  const session = await auth.api.getSession({ headers: await headers() });
  const symbols = await getWatchlistSymbolsByEmail(session.user.email);

  return (
    <div>
      <h1>My Watchlist</h1>
      {symbols.map(symbol => (
        <div key={symbol}>{symbol}</div>
      ))}
    </div>
  );
}
```

2. æ·»åŠ å¯¼èˆªé“¾æ¥ `lib/constants.ts`ï¼š

```typescript
export const NAV_ITEMS = [
    { href: '/', label: 'Dashboard' },
    { href: '/watchlist', label: 'Watchlist' },  // æ–°å¢
];
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### å·²å®ç°çš„ä¼˜åŒ–

1. **Server Components** - å‡å°‘å®¢æˆ·ç«¯JavaScript
2. **React cache** - åŒä¸€è¯·æ±‚å‘¨æœŸå¤ç”¨æ•°æ®
3. **Next.js fetchç¼“å­˜** - APIå“åº”ç¼“å­˜
4. **é˜²æŠ–** - æœç´¢è¾“å…¥é˜²æŠ–ï¼ˆ300msï¼‰
5. **LeanæŸ¥è¯¢** - MongoDBæŸ¥è¯¢ä¼˜åŒ–
6. **ç´¢å¼•** - æ•°æ®åº“ç´¢å¼•åŠ é€ŸæŸ¥è¯¢

### å¯æ·»åŠ çš„ä¼˜åŒ–

1. **åŠ¨æ€å¯¼å…¥ï¼š**
```typescript
import dynamic from 'next/dynamic';

const TradingViewWidget = dynamic(() => import('@/components/TradingViewWidget'), {
  ssr: false,
  loading: () => <div>Loading chart...</div>
});
```

2. **å›¾ç‰‡ä¼˜åŒ–ï¼š**
```typescript
import Image from 'next/image';

<Image
  src="/logo.png"
  width={140}
  height={32}
  priority  // ä¼˜å…ˆåŠ è½½
/>
```

3. **Redisç¼“å­˜ï¼ˆé«˜çº§ï¼‰ï¼š**
```typescript
import Redis from 'ioredis';
const redis = new Redis(process.env.REDIS_URL);

// ç¼“å­˜è‚¡ç¥¨æœç´¢ç»“æœ
const cacheKey = `search:${query}`;
const cached = await redis.get(cacheKey);
if (cached) return JSON.parse(cached);

const results = await fetchFromAPI(query);
await redis.set(cacheKey, JSON.stringify(results), 'EX', 1800);  // 30åˆ†é’Ÿ
```

---

## ğŸ”’ å®‰å…¨æœ€ä½³å®è·µ

### å·²å®ç°

âœ… Session-basedè®¤è¯
âœ… HttpOnly Cookies
âœ… CSRFé˜²æŠ¤ï¼ˆSameSiteï¼‰
âœ… å¯†ç å“ˆå¸Œï¼ˆBetter Authï¼‰
âœ… ç¯å¢ƒå˜é‡éš”ç¦»

### å»ºè®®å¢å¼º

1. **å¯ç”¨é‚®ç®±éªŒè¯ï¼š**
```typescript
// lib/better-auth/auth.ts
emailAndPassword: {
    requireEmailVerification: true,  // æ”¹ä¸ºtrue
}
```

2. **æ·»åŠ é€Ÿç‡é™åˆ¶ï¼š**
```bash
npm install @upstash/ratelimit @upstash/redis
```

```typescript
import { Ratelimit } from '@upstash/ratelimit';

const ratelimit = new Ratelimit({
  redis: Redis.fromEnv(),
  limiter: Ratelimit.slidingWindow(10, '10 s'),
});

// åœ¨Server Actionä¸­ä½¿ç”¨
const { success } = await ratelimit.limit(userId);
if (!success) throw new Error('Rate limit exceeded');
```

3. **æ·»åŠ CSPå¤´ï¼š**
```typescript
// next.config.ts
const nextConfig = {
  async headers() {
    return [{
      source: '/:path*',
      headers: [{
        key: 'Content-Security-Policy',
        value: "default-src 'self'; script-src 'self' 'unsafe-eval' https://s3.tradingview.com;"
      }]
    }];
  }
};
```

---

## ğŸ“Š éƒ¨ç½²æŒ‡å—

### æ¨èï¼šVerceléƒ¨ç½²

**æ­¥éª¤1ï¼šå‡†å¤‡ä»£ç **
```bash
git add .
git commit -m "Ready for deployment"
git push origin main
```

**æ­¥éª¤2ï¼šå¯¼å…¥åˆ°Vercel**
1. è®¿é—® https://vercel.com/new
2. å¯¼å…¥GitHubä»“åº“
3. é…ç½®é¡¹ç›®

**æ­¥éª¤3ï¼šé…ç½®ç¯å¢ƒå˜é‡**

åœ¨Vercel Dashboardæ·»åŠ æ‰€æœ‰ç¯å¢ƒå˜é‡ï¼š
- `MONGODB_URI`
- `BETTER_AUTH_SECRET`
- `BETTER_AUTH_URL` = https://yourdomain.com
- `FINNHUB_API_KEY`
- `GEMINI_API_KEY`
- `NODEMAILER_EMAIL`
- `NODEMAILER_PASSWORD`

**æ­¥éª¤4ï¼šéƒ¨ç½²**
- Vercelè‡ªåŠ¨æ„å»ºå’Œéƒ¨ç½²
- æ¯æ¬¡pushåˆ°mainåˆ†æ”¯è‡ªåŠ¨é‡æ–°éƒ¨ç½²

**æ­¥éª¤5ï¼šé…ç½®Inngest**
1. è®¿é—® https://app.inngest.com
2. æ·»åŠ Event Key
3. é…ç½®Webhook URL: `https://yourdomain.com/api/inngest`

---

## ğŸ“ æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### é—®é¢˜1ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥

**é”™è¯¯ä¿¡æ¯ï¼š**
```
MongoServerError: Authentication failed
```

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥`MONGODB_URI`æ ¼å¼
2. ç¡®è®¤æ•°æ®åº“ç”¨æˆ·åå¯†ç æ­£ç¡®
3. MongoDB Atlasï¼šæ£€æŸ¥IPç™½åå•ï¼ˆå…è®¸0.0.0.0/0ï¼‰
4. æµ‹è¯•è¿æ¥ï¼š`npm run test:db`

---

#### é—®é¢˜2ï¼šInngestäº‹ä»¶æœªè§¦å‘

**ç—‡çŠ¶ï¼š** æ³¨å†Œåæœªæ”¶åˆ°æ¬¢è¿é‚®ä»¶

**æ£€æŸ¥æ¸…å•ï¼š**
1. Inngest Dev Serveræ˜¯å¦è¿è¡Œï¼ˆ`npx inngest-cli@latest dev`ï¼‰
2. æ£€æŸ¥ç»ˆç«¯æ—¥å¿—æ˜¯å¦æœ‰é”™è¯¯
3. è®¿é—® http://localhost:8288 æŸ¥çœ‹äº‹ä»¶æ—¥å¿—
4. ç¡®è®¤`GEMINI_API_KEY`å’Œ`NODEMAILER_*`é…ç½®æ­£ç¡®

---

#### é—®é¢˜3ï¼šæœç´¢åŠŸèƒ½æ— å“åº”

**æ£€æŸ¥æ¸…å•ï¼š**
1. ç¡®è®¤`FINNHUB_API_KEY`å·²é…ç½®
2. æ£€æŸ¥æµè§ˆå™¨Consoleæ˜¯å¦æœ‰é”™è¯¯
3. æŸ¥çœ‹Networkæ ‡ç­¾ï¼ŒAPIè¯·æ±‚æ˜¯å¦æˆåŠŸ
4. Finnhubå…è´¹å±‚çº§ï¼šç¡®ä¿æœªè¶…å‡º60æ¬¡/åˆ†é’Ÿé™åˆ¶

---

## ğŸ“ å­¦ä¹ èµ„æº

### å®˜æ–¹æ–‡æ¡£

- **Next.js:** https://nextjs.org/docs
- **React:** https://react.dev
- **Tailwind CSS:** https://tailwindcss.com/docs
- **Better Auth:** https://www.better-auth.com/docs
- **Inngest:** https://www.inngest.com/docs
- **MongoDB:** https://www.mongodb.com/docs
- **Finnhub:** https://finnhub.io/docs/api

### æ¨èæ•™ç¨‹

- Next.js 15æ–°ç‰¹æ€§
- Server Actionsè¯¦è§£
- MongoDBç´¢å¼•ä¼˜åŒ–
- Inngestäº‹ä»¶é©±åŠ¨æ¶æ„

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0
**æœ€åæ›´æ–°ï¼š** 2025-11-16
**ä½œè€…ï¼š** AIæŠ€æœ¯æ–‡æ¡£ç”Ÿæˆå™¨
**è¯­è¨€ï¼š** ç®€ä½“ä¸­æ–‡
